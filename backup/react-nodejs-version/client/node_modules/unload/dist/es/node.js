// set to true to log events
var DEBUG = false;

function add(fn) {
  process.on('exit', function () {
    DEBUG && 
    return fn();
  });
  /**
   * on the following events,
   * the process will not end if there are
   * event-handlers attached,
   * therefore we have to call process.exit()
   */

  process.on('beforeExit', function () {
    DEBUG && 
    return fn().then(function () {
      return process.exit();
    });
  }); // catches ctrl+c event

  process.on('SIGINT', function () {
    DEBUG && 
    return fn().then(function () {
      return process.exit();
    });
  }); // catches uncaught exceptions

  process.on('uncaughtException', function (err) {
    DEBUG && 
    return fn().then(function () {

      process.exit(1);
    });
  });
}

export default {
  add: add
};